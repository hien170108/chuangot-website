<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi Tiết Sản Phẩm - Chua&Ngọt</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="img/favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playwrite+DK+Loopet:wght@100..400&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <h1><span class="chua">Chua</span>&<span class="ngot">Ngọt</span></h1>
            </div>
            <nav>
                <ul class="menu">
                    <li><a href="index.html">Trang Chủ</a></li>
                    <li><a href="about.html">Giới Thiệu</a></li>
                    <li><a href="products.html" class="active">Sản Phẩm</a></li>
                    <li><a href="feedback.html">Đánh Giá</a></li>
                    
                </ul>
            </nav>
            <div class="theme-toggle">
                <span class="theme-toggle-icon"><i class="fas fa-sun"></i></span>
                <label class="theme-toggle-label">
                    <input type="checkbox" class="theme-toggle-checkbox" id="theme-toggle">
                    <span class="theme-toggle-slider"></span>
                </label>
                <span class="theme-toggle-icon"><i class="fas fa-moon"></i></span>
            </div>
            <div class="mobile-menu-btn">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </header>

    <section class="page-banner">
        <div class="container">
            <h1>Chi Tiết Sản Phẩm</h1>
            <p>
                <a href="index.html">Trang Chủ</a> &gt; 
                <a href="products.html">Sản Phẩm</a> &gt; 
                <span id="productName">Chi Tiết Sản Phẩm</span>
            </p>
        </div>
        <!-- Yogurt bubbles decoration -->
        <div class="yogurt-bubble" style="width: 40px; height: 40px; top: 20%; left: 10%; animation-delay: 0.5s;"></div>
        <div class="yogurt-bubble" style="width: 25px; height: 25px; top: 30%; left: 25%; animation-delay: 1.2s;"></div>
        <div class="yogurt-bubble" style="width: 35px; height: 35px; top: 15%; right: 15%; animation-delay: 0.8s;"></div>
        <div class="yogurt-bubble" style="width: 30px; height: 30px; top: 40%; right: 20%; animation-delay: 1.5s;"></div>
    </section>

    <section class="product-detail">
        <div class="container">
            <div class="product-detail-content" id="productDetail">
                <!-- Chi tiết sản phẩm sẽ được thêm vào đây bằng JavaScript -->
            </div>

            <div class="product-description" id="productDescription">
                <!-- Mô tả sản phẩm sẽ được thêm vào đây bằng JavaScript -->
            </div>

            <div class="product-nutrition" id="productNutrition">
                <!-- Thông tin dinh dưỡng sẽ được thêm vào đây bằng JavaScript -->
            </div>

            <div class="related-products">
                <h2>Sản Phẩm Liên Quan</h2>
                <div class="related-products-container" id="relatedProducts">
                    <!-- Sản phẩm liên quan sẽ được thêm vào đây bằng JavaScript -->
                </div>
            </div>
        </div>
        <!-- Yogurt bubbles decoration -->
        <div class="yogurt-bubble" style="width: 45px; height: 45px; bottom: 20%; left: 8%; animation-delay: 1.8s;"></div>
        <div class="yogurt-bubble" style="width: 30px; height: 30px; bottom: 40%; left: 20%; animation-delay: 2.2s;"></div>
        <div class="yogurt-bubble" style="width: 35px; height: 35px; bottom: 15%; right: 12%; animation-delay: 1.3s;"></div>
        <div class="yogurt-bubble" style="width: 25px; height: 25px; bottom: 35%; right: 22%; animation-delay: 2.5s;"></div>
    </section>

    <section class="contact-cta">
        <div class="container">
            <div class="cta-content" data-aos="fade-up">
                <h2>Đặt Hàng Ngay Hôm Nay</h2>
                <p>Gọi điện hoặc nhắn tin qua Zalo để đặt hàng và nhận tư vấn</p>
                <a href="tel:0382092008" class="btn-phone">
                    <i class="fas fa-phone-alt"></i> 0382092008
                </a>
                <a href="https://zalo.me/0382092008" class="btn-zalo" target="_blank">
                    <i class="fas fa-comment"></i> Zalo
                </a>
            </div>
        </div>
        <!-- Yogurt bubbles decoration -->
        <div class="yogurt-bubble" style="width: 50px; height: 50px; bottom: 15%; right: 20%; animation-delay: 1.2s;"></div>
        <div class="yogurt-bubble" style="width: 35px; height: 35px; top: 25%; left: 25%; animation-delay: 2.2s;"></div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h2><span class="chua">Chua</span>&<span class="ngot">Ngọt</span></h2>
                    <p>Chua vừa, Ngọt đủ!</p>
                </div>
                <div class="footer-links">
                    <h3>Liên Kết</h3>
                    <ul>
                        <li><a href="index.html">Trang Chủ</a></li>
                        <li><a href="about.html">Giới Thiệu</a></li>
                        <li><a href="products.html">Sản Phẩm</a></li>
                        <li><a href="feedback.html">Đánh Giá</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h3>Liên Hệ</h3>
                    <p><i class="fas fa-map-marker-alt"></i> 464 Quang Trung, Hà Đông, Hà Nội</p>
                    <p><i class="fas fa-phone"></i> 0382092008</p>
                    <p><i class="fas fa-envelope"></i> ngotvachua@gmail.com</p>
                </div>
                <div class="footer-social">
                    <h3>Kết Nối</h3>
                    <div class="social-icons">
                        <a href="https://www.facebook.com/profile.php?id=61576622030774" target="_blank"><i class="fab fa-facebook"></i></a>
                        <a href="https://www.tiktok.com/@chuavuangotdu" target="_blank"><i class="fab fa-tiktok"></i></a>
                        <a href="https://www.instagram.com/chua_va_ngot" target="_blank"><i class="fab fa-instagram"></i></a>
                        <a href="https://zalo.me/0382092008" target="_blank"><i class="fas fa-comment"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Chua&Ngọt.</p>
            </div>
        </div>
    </footer>
    <div class="back-to-top">
      <i class="fas fa-arrow-up"></i>
    </div>

    <script>
      function getQueryParam(name) {
        const url = new URL(window.location.href);
        return url.searchParams.get(name);
      }
      function renderProductDetail(product) {
        document.getElementById("productDetail").innerHTML = `
          <div class="product-detail-image">
            <img src="${product.image}" alt="${product.name}">
          </div>
          <div class="product-detail-info">
            <h1>${product.name}</h1>
            <p class="product-detail-price">${product.price}</p>
            <div class="product-detail-desc">
              <p>${product.description}</p>
              <p>${product.longDescription || ""}</p>
            </div>
            <div class="product-detail-meta">
              <div class="meta-item"><span class="meta-label">Danh mục:</span> <span>${product.categoryName || ""}</span></div>
              <div class="meta-item"><span class="meta-label">Khối lượng:</span> <span>150g</span></div>
              <div class="meta-item"><span class="meta-label">Hạn sử dụng:</span> <span>7 ngày kể từ ngày mua</span></div>
              <div class="meta-item"><span class="meta-label">Bảo quản:</span> <span>2-5°C</span></div>
            </div>
            <div class="contact-buttons">
              <a href="tel:0382092008" class="btn-phone"><i class="fas fa-phone-alt"></i> Gọi Đặt Hàng: 0382092008</a>
              <a href="https://zalo.me/0382092008" class="btn-zalo" target="_blank"><i class="fas fa-comment"></i> Zalo</a>
            </div>
          </div>
        `;
        // Render mô tả
        document.getElementById("productDescription").innerHTML = `
          <h2>Mô Tả Sản Phẩm</h2>
          <div class="description-content">
            <p>${product.longDescription || product.description}</p>
          </div>
        `;
        // Render nutrition
        const n = product.nutrition || {};
        document.getElementById("productNutrition").innerHTML = `
          <h2>Thông Tin Dinh Dưỡng</h2>
          <table class="nutrition-table">
            <thead>
              <tr>
                <th>Thành phần</th>
                <th>Lượng (trên 100g)</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Calo</td><td>${n.calories || ""}</td></tr>
              <tr><td>Chất béo</td><td>${n.fat || ""}</td></tr>
              <tr><td>Chất béo bão hòa</td><td>${n.saturatedFat || ""}</td></tr>
              <tr><td>Cholesterol</td><td>${n.cholesterol || ""}</td></tr>
              <tr><td>Natri</td><td>${n.sodium || ""}</td></tr>
              <tr><td>Carbohydrate</td><td>${n.carbs || ""}</td></tr>
              <tr><td>Đường</td><td>${n.sugar || ""}</td></tr>
              <tr><td>Protein</td><td>${n.protein || ""}</td></tr>
              <tr><td>Canxi</td><td>${n.calcium || ""}</td></tr>
              <tr><td>Vitamin D</td><td>${n.vitaminD || ""}</td></tr>
            </tbody>
          </table>
        `;
      }
      function renderRelatedProducts(currentId, category) {
        fetch("api/products.php?category=" + encodeURIComponent(category))
          .then(res => res.json())
          .then(data => {
            if (data.status && data.data) {
              const related = data.data.filter(p => p.id != currentId).slice(0, 4);
              const container = document.getElementById("relatedProducts");
              container.innerHTML = "";
              related.forEach(product => {
                const el = document.createElement("div");
                el.className = "product-card";
                el.innerHTML = `
                  <div class="product-image">
                    <img src="${product.image}" alt="${product.name}">
                  </div>
                  <div class="product-info">
                    <h3>${product.name}</h3>
                    <p class="price">${product.price}</p>
                    <a href="product-detail.html?id=${product.id}" class="btn-secondary">Xem Chi Tiết</a>
                  </div>
                `;
                container.appendChild(el);
              });
            }
          });
      }
      document.addEventListener("DOMContentLoaded", function() {
        const id = getQueryParam("id");
        if (!id) return;
        fetch("api/products.php?id=" + id)
          .then(res => res.json())
          .then(data => {
            if (data.status && data.data && data.data.length > 0) {
              const product = data.data[0];
              document.title = `${product.name} - Chua&Ngọt`;
              const productName = document.getElementById("productName");
              if (productName) productName.textContent = product.name;
              renderProductDetail(product);
              renderRelatedProducts(product.id, product.category);
            } else {
              document.getElementById("productDetail").innerHTML = `
                <div class="product-not-found">
                  <h2>Không tìm thấy sản phẩm</h2>
                  <p>Sản phẩm bạn đang tìm kiếm không tồn tại hoặc đã bị xóa.</p>
                  <a href="products.html" class="btn">Quay lại trang sản phẩm</a>
                </div>
              `;
              document.getElementById("productDescription").style.display = "none";
              document.getElementById("productNutrition").style.display = "none";
              document.querySelector(".related-products").style.display = "none";
            }
          });
      });
    </script>
    <script src="script.js"></script>
</body>
</html>
